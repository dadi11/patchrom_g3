*** Window.smali	2016-03-24 11:22:10.663329364 +0100
--- Window.smali	2016-03-24 11:19:21.135329364 +0100
***************
*** 1265,1270 ****
  
      iput v1, v0, Landroid/view/WindowManager$LayoutParams;->flags:I
  
      const/high16 v1, 0x40000000    # 2.0f
  
      and-int/2addr v1, p2
--- 1355,1379 ----
  
      iput v1, v0, Landroid/view/WindowManager$LayoutParams;->flags:I
  
+     and-int v1, p2, v3
+ 
+     if-eqz v1, :cond_miui_0
+ 
+     and-int v1, p1, v3
+ 
+     if-nez v1, :cond_miui_0
+ 
+     iget v1, v0, Landroid/view/WindowManager$LayoutParams;->extraFlags:I
+ 
+     and-int/lit8 v1, v1, 0x1
+ 
+     if-eqz v1, :cond_miui_0
+ 
+     const/4 v1, 0x1
+ 
+     invoke-virtual {p0, v1}, Landroid/view/Window;->clearExtraFlags(I)V
+ 
+     :cond_miui_0
      const/high16 v1, 0x40000000    # 2.0f
  
      and-int/2addr v1, p2
